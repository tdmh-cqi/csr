<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request Form</title>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
    <style>
        body { font-family: sans-serif; background-color: #f4f7f6; padding: 20px; }
        .form-container { max-width: 600px; margin: auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        
        h2 { text-align: center; color: #333; }
        .form-no { color: red; font-weight: bold; font-size: 1.2em; float: right; }
        
        .field-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        
        /* Signature Pad Styles */
        .signature-wrapper { border: 1px solid #000; background: #fff; width: 100%; height: 200px; position: relative; }
        canvas { width: 100%; height: 100%; cursor: crosshair; }
        .clear-btn { margin-top: 5px; background: #ff4d4d; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px; }

        button[type="submit"] { width: 100%; background: #28a745; color: white; border: none; padding: 12px; font-size: 16px; border-radius: 4px; cursor: pointer; margin-top: 20px; }
        button[type="submit"]:hover { background: #218838; }
    </style>
</head>
<body>

<div class="form-container">
    <div class="form-no">Form No: <span id="formNumber"></span></div>
    <h2>Request Form</h2>
    <hr>

    <form id="requestForm">
        <div class="field-group">
            <label>Requesting Department</label>
            <input type="text" name="department" required>
        </div>

        <div class="field-group">
            <label>Date</label>
            <input type="date" name="requestDate" id="currentDate" required>
        </div>

        <div class="field-group">
            <label>Item Description</label>
            <textarea name="description" rows="3" required></textarea>
        </div>

        <div style="display: flex; gap: 10px;">
            <div class="field-group" style="flex: 2;">
                <label>Quantity/Unit</label>
                <input type="text" name="quantity" placeholder="e.g. 10 pcs" required>
            </div>
            <div class="field-group" style="flex: 2;">
                <label>Requested By</label>
                <input type="text" name="requester" required>
            </div>
        </div>

        <div class="field-group">
            <label>Upload Image</label>
            <input type="file" name="itemImage" accept="image/*">
        </div>

        <div class="field-group">
            <label>Received By (Draw Signature Below)</label>
            <div class="signature-wrapper">
                <canvas id="signature-pad"></canvas>
            </div>
            <button type="button" class="clear-btn" id="clear">Clear Signature</button>
        </div>

        <button type="submit">Submit Request</button>
    </form>
</div>

<script>
    // 1. Automated Form Number (based on timestamp for uniqueness)
    const formNum = "REQ-" + Math.floor(Date.now() / 1000);
    document.getElementById('formNumber').innerText = formNum;

    // 2. Set default date to today
    document.getElementById('currentDate').valueAsDate = new Date();

    // 3. Initialize Signature Pad
    const canvas = document.getElementById('signature-pad');
    const signaturePad = new SignaturePad(canvas);

    // Adjust canvas size for high-resolution screens
    function resizeCanvas() {
        const ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        canvas.getContext("2d").scale(ratio, ratio);
        signaturePad.clear();
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas();

    document.getElementById('clear').addEventListener('click', () => {
        signaturePad.clear();
    });

    // 4. Form Submission Handling
    document.getElementById('requestForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (signaturePad.isEmpty()) {
            alert("Please provide a signature.");
            return;
        }

        const signatureData = signaturePad.toDataURL(); // Base64 image of signature
        alert("Form Submitted Successfully!\nForm Number: " + formNum);
        console.log("Signature Data:", signatureData);
        // Here you would typically send the data to a server/database
    });
</script>

</body>
</html>
